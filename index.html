<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GAMEND - Premium Hub</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <style>
        /* --- START: 100% OLD PREMIUM STYLE (DO NOT CHANGE) --- */
        :root {
            --tg-theme-bg: #0f0f1a;
            --accent: #00f2ff;
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
            --text: #ffffff;
        }

        body.light-theme {
            --tg-theme-bg: #f4f7f9;
            --glass: rgba(0, 0, 0, 0.08);
            --border: rgba(0, 0, 0, 0.15);
            --text: #1a1a2e;
            background: radial-gradient(circle at top, #ffffff 0%, #dbe2e8 100%) !important;
        }

        body {
            background: radial-gradient(circle at top, #1a1a2e 0%, #0f0f1a 100%);
            color: var(--text); margin: 0; font-family: 'Inter', sans-serif;
            display: flex; flex-direction: column; align-items: center; min-height: 100vh;
            overflow-x: hidden; transition: 0.3s;
        }

        #splash-screen {
            position: fixed; inset: 0; z-index: 10000; background: #000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .loader-logo { width: 100px; height: 100px; border-radius: 25px; box-shadow: 0 0 25px var(--accent); }
        .progress-bar { width: 60%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 10px; margin-top: 20px; overflow: hidden; }
        .progress-fill { width: 0%; height: 100%; background: var(--accent); transition: width 5s linear; }

        #hub-content { display: none; width: 100%; text-align: center; }
        header { width: 100%; padding: 40px 0 20px; position: relative; }
        .logo-text { font-size: 32px; font-weight: 900; background: linear-gradient(to right, #00f2ff, #0072ff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .game-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 90%; max-width: 450px; padding: 20px 0; margin: 0 auto; }
        .card { background: var(--glass); backdrop-filter: blur(12px); border: 1px solid var(--border); border-radius: 24px; padding: 20px; display: flex; flex-direction: column; align-items: center; transition: 0.3s; }
        .card:active { transform: scale(0.92); border-color: var(--accent); }
        .icon-img { width: 64px; height: 64px; border-radius: 18px; object-fit: cover; margin-bottom: 12px; }
        .title { font-weight: 700; font-size: 15px; margin: 0; color: inherit; }
        .tag { font-size: 10px; color: var(--accent); text-transform: uppercase; margin-top: 4px; font-weight: bold; }
        .share-btn { background: var(--accent); color: #000; padding: 14px 35px; border-radius: 100px; font-weight: bold; border: none; margin: 25px 0; cursor: pointer; }
        /* --- END: OLD STYLE --- */

        /* 3-DOT MENU STYLING */
        .menu-btn { position: absolute; right: 25px; top: 42px; cursor: pointer; font-size: 26px; color: var(--accent); z-index: 1001; }
        .menu-dropdown {
            position: absolute; right: 25px; top: 85px; background: rgba(20, 20, 35, 0.98);
            border: 1px solid var(--border); border-radius: 18px; width: 160px;
            display: none; flex-direction: column; text-align: left; backdrop-filter: blur(15px); z-index: 5000;
        }
        .menu-item { padding: 14px 20px; font-size: 14px; border-bottom: 1px solid var(--border); color: #fff; cursor: pointer; }
        .menu-item:last-child { border-bottom: none; }
    </style>
</head>
<body onclick="closeMenu()">

    <div id="splash-screen">
        <img src="https://mozhihub.github.io/Mad-drive/img/drivemad.png" class="loader-logo">
        <h2 style="letter-spacing: 4px; color: #fff;">GAMEND</h2>
        <div class="progress-bar"><div class="progress-fill" id="fill"></div></div>
    </div>

    <div id="hub-content">
        <header>
            <div class="menu-btn" onclick="toggleMenu(event)">‚ãÆ</div>
            <div class="menu-dropdown" id="dropdown">
                <div class="menu-item" onclick="logicSettings(event)">Settings</div>
                <div class="menu-item" onclick="logicAbout(event)">About</div>
                <div class="menu-item" onclick="logicContact(event)">Contact</div>
                <div class="menu-item" onclick="logicReport(event)">Report</div>
            </div>
            <div class="logo-text">GAMEND HUB</div>
            <div style="font-size: 12px; color: #00ff88;">‚óè <span id="online-val">...</span> PLAYERS ONLINE</div>
        </header>

        <div class="game-container">
            <div class="card" onclick="openGame('https://mozhihub.github.io/Mad-drive/')">
                <img src="https://mozhihub.github.io/Mad-drive/img/drivemad.png" class="icon-img"><p class="title">Mad Drive</p><span class="tag">Racing</span>
            </div>
            <div class="card" onclick="openGame('https://mozhihub.github.io/Knife/')">
                <img src="https://via.placeholder.com/64/0072ff/fff?text=üî™" class="icon-img"><p class="title">Knife Hit</p><span class="tag">Arcade</span>
            </div>
            <div class="card" onclick="openGame('https://mozhihub.github.io/Hexa/')">
                <img src="https://via.placeholder.com/64/f39c12/fff?text=üß©" class="icon-img"><p class="title">Hexa</p><span class="tag">Puzzle</span>
            </div>
            <div class="card" onclick="openGame('https://mozhihub.github.io/insto/')">
                <img src="https://via.placeholder.com/64/e1306c/fff?text=üì∏" class="icon-img"><p class="title">Insto</p><span class="tag">Social</span>
            </div>
            <div class="card" onclick="openGame('https://mozhihub.github.io/Paint/')">
                <img src="https://via.placeholder.com/64/2ecc71/fff?text=üé®" class="icon-img"><p class="title">Paint</p><span class="tag">Creative</span>
            </div>
            <div class="card" onclick="openGame('https://mozhihub.github.io/Love-Calculator/')">
                <img src="https://via.placeholder.com/64/e74c3c/fff?text=‚ù§Ô∏è" class="icon-img"><p class="title">Love Calc</p><span class="tag">Fun</span>
            </div>
        </div>

        <button class="share-btn" onclick="shareBot()">INVITE FRIENDS</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        window.onload = () => {
            document.getElementById('fill').style.width = '100%';
            setTimeout(() => {
                document.getElementById('splash-screen').style.display = 'none';
                document.getElementById('hub-content').style.display = 'block';
                tg.BackButton.show();
            }, 5000);
        };

        // --- MENU LOGIC ---
        function toggleMenu(e) { e.stopPropagation(); const dd = document.getElementById('dropdown'); dd.style.display = (dd.style.display === 'flex') ? 'none' : 'flex'; }
        function closeMenu() { document.getElementById('dropdown').style.display = 'none'; }

        function logicSettings(e) {
            e.stopPropagation(); closeMenu();
            tg.showPopup({
                title: 'Settings',
                message: 'Select Theme:',
                buttons: [{id:'d', text:'Dark Mode'}, {id:'l', text:'Light Mode'}, {type:'cancel'}]
            }, (id) => {
                if(id === 'l') document.body.classList.add('light-theme');
                if(id === 'd') document.body.classList.remove('light-theme');
            });
        }

        function logicAbout(e) {
            e.stopPropagation(); closeMenu();
            tg.showPopup({
                title: 'About GAMEND',
                message: 'Premium arcade games for Telegram.\n\nProvided by: mozhihub.com',
                buttons: [{type:'close'}]
            });
        }

        function logicContact(e) {
            e.stopPropagation(); closeMenu();
            tg.showPopup({
                title: 'Contact Us',
                message: 'Website: mozhihub.com\nEmail: info@mozhihub.com',
                buttons: [{id:'visit', text:'Visit Web'}, {type:'close'}]
            }, (id) => { if(id === 'visit') tg.openLink('https://mozhihub.com'); });
        }

        function logicReport(e) {
            e.stopPropagation(); closeMenu();
            tg.showConfirm("Send report to kaviyarasan@mozhihub.com?", (ok) => {
                if(ok) tg.openLink("mailto:kaviyarasan@mozhihub.com?subject=GamendBot Report");
            });
        }

        function openGame(url) { if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium'); window.location.href = url; }
        function shareBot() { tg.openTelegramLink("https://t.me/share/url?url=https://t.me/gamendbot&text=Play Games!"); }
        
        tg.onEvent('backButtonClicked', () => { tg.showConfirm("Exit GAMEND?", (ok) => { if(ok) tg.close(); }); });

        const firebaseConfig = { apiKey: "AIzaSyBb0upYoLF4_isVBfJUAMOEflMCgl5_5aE", databaseURL: "https://game-3a2e9-default-rtdb.asia-southeast1.firebasedatabase.app", projectId: "game-3a2e9" };
        firebase.initializeApp(firebaseConfig);
        firebase.database().ref('global_players').on('value', snap => { document.getElementById('online-val').innerText = snap.val() || 1; });
    </script>
</body>
</html>
